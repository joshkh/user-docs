
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GFF3 &mdash; InterMine  documentation</title>
    
    <link rel="stylesheet" href="../../../_static/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="InterMine  documentation" href="../../../index.html" />
    <link rel="up" title="Data Source Library" href="index.html" />
    <link rel="next" title="Identifier Data Sources" href="identifiers/index.html" />
    <link rel="prev" title="FASTA" href="fasta.html" /><!-- syntax highlighting -->
<link href="../../../_static/pygments/radek.css" rel="stylesheet">
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="identifiers/index.html" title="Identifier Data Sources"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fasta.html" title="FASTA"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../index.html">InterMine  documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Database</a> &raquo;</li>
          <li><a href="../index.html" >Data Sources</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Data Source Library</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">GFF3</a><ul>
<li><a class="reference internal" href="#types-of-data-loaded">Types of data loaded</a></li>
<li><a class="reference internal" href="#how-to-download-the-data">How to download the data</a></li>
<li><a class="reference internal" href="#how-to-load-the-data-into-your-mine">How to load the data into your mine</a><ul>
<li><a class="reference internal" href="#parent-relationship">Parent relationship</a><ul>
<li><a class="reference internal" href="#project-xml">Project XML</a></li>
<li><a class="reference internal" href="#writing-a-custom-gff-parser">Writing a custom GFF parser</a></li>
</ul>
</li>
<li><a class="reference internal" href="#make-source-script">Make Source script</a></li>
<li><a class="reference internal" href="#java-code">Java code</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fasta.html"
                        title="previous chapter">FASTA</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="identifiers/index.html"
                        title="next chapter">Identifier Data Sources</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/database/data-sources/library/gff.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="gff3">
<h1>GFF3<a class="headerlink" href="#gff3" title="Permalink to this headline">¶</a></h1>
<p>InterMine comes with a GFF parser which loads GFF3 data files into your mine - without writing any Perl or Java code. This isn&#8217;t a source itself but genome annotation from gff files can be loaded easily by creating a new source of type gff.  See redfly, malaria-gff and tiffin for examples.</p>
<p>Configuration is added to the <cite>project.properties</cite> file and an optional handler can be added to deal with data in the attributes section of the gff file.</p>
<div class="section" id="types-of-data-loaded">
<h2>Types of data loaded<a class="headerlink" href="#types-of-data-loaded" title="Permalink to this headline">¶</a></h2>
<p>sequence features</p>
</div>
<div class="section" id="how-to-download-the-data">
<h2>How to download the data<a class="headerlink" href="#how-to-download-the-data" title="Permalink to this headline">¶</a></h2>
<p>N/A - will parse any file in GFF3 format</p>
</div>
<div class="section" id="how-to-load-the-data-into-your-mine">
<h2>How to load the data into your mine<a class="headerlink" href="#how-to-load-the-data-into-your-mine" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>place valid GFF3 files into a directory</li>
<li>add entry to project XML file</li>
<li>run build</li>
</ol>
<div class="highlight-properties"><div class="highlight"><pre><span class="c"># example GFF3 file</span>
<span class="na">MAL1    ApiDB   gene    183057  184457  .       -       .       ID</span><span class="o">=</span><span class="s">gene.46311;description=hypothetical%20protein;Name=PFA0210c</span>
<span class="na">MAL1    ApiDB   mRNA    183057  184457  .       +       .       ID</span><span class="o">=</span><span class="s">mRNA.46312;Parent=gene.46311</span>
</pre></div>
</div>
<p>If you follow the above steps with this data file, the following will happen:</p>
<ol class="arabic simple">
<li>gene and mRNA objects created</li>
<li>&#8220;MAL1&#8221; will be the identifier</li>
<li>start = 183057, end = 184457</li>
<li>gene will be located in -1 strand, mRNA will be located on the 1 strand.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By default, columns such as &#8220;type&#8221;, &#8220;start&#8221;, &#8220;end&#8221;, &#8220;strand&#8221; and &#8220;ID&#8221; field in &#8220;attributes&#8221; column are parsed automatically. To do more processing or access the attributes, you are able to configure in gff_config.properties. For more advanced processing, you will have to write your own GFF3 parser.  See below for details.</p>
</div>
<div class="highlight-properties"><div class="highlight"><pre><span class="c"># gff_config.properties example for E. coil gff3 attributes</span>
<span class="na">511145.terms</span><span class="o">=</span><span class="s">gene,exon                             # feature types to load, e.g. load gene and exon for E. coli</span>
<span class="na">511145.attributes.Dbxref.EcoGene</span><span class="o">=</span><span class="s">primaryIdentifier # use Dbxref EcoGene field as primaryIdentifier</span>
<span class="na">511145.attributes.locus_tag</span><span class="o">=</span><span class="s">secondaryIdentifier    # use locus_tag field as secondaryIdentifier</span>
<span class="na">511145.attributes.gene</span><span class="o">=</span><span class="s">symbol                      # use gene field as symbol</span>
<span class="na">511145.attributes.gene_synonym</span><span class="o">=</span><span class="s">synonym             # use gene_synonym field for synonym</span>
<span class="na">511145.exon.attributes.type</span><span class="o">=</span><span class="s">scoreType              # a class specific attribute</span>
</pre></div>
</div>
<div class="section" id="parent-relationship">
<h3>Parent relationship<a class="headerlink" href="#parent-relationship" title="Permalink to this headline">¶</a></h3>
<p>The parent-child relationship between features can also be handled automatically if you set it up properly. Take MalariaGFF3RecordHandler for example:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="nf">MalariaGFF3RecordHandler</span><span class="o">(</span><span class="n">Model</span> <span class="n">tgtModel</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">tgtModel</span><span class="o">);</span>
    <span class="c1">// refsAndCollections controls references and collections that are set from the</span>
    <span class="c1">// Parent= attributes in the GFF3 file.</span>
    <span class="n">refsAndCollections</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;Exon&quot;</span><span class="o">,</span> <span class="s">&quot;transcripts&quot;</span><span class="o">);</span>
    <span class="n">refsAndCollections</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;MRNA&quot;</span><span class="o">,</span> <span class="s">&quot;gene&quot;</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="section" id="project-xml">
<h4>Project XML<a class="headerlink" href="#project-xml" title="Permalink to this headline">¶</a></h4>
<p>Here is an example GFF3 entry in the project XML file:</p>
<div class="highlight-xml"><div class="highlight"><pre>    # add to project.xml file
    # NOTE: update the &quot;type&quot; if you are using your own custom GFF3 parser

<span class="nt">&lt;source</span> <span class="na">name=</span><span class="s">&quot;example-gff3&quot;</span> <span class="na">type=</span><span class="s">&quot;gff&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;gff3.taxonId&quot;</span> <span class="na">value=</span><span class="s">&quot;7227&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;gff3.seqClsName&quot;</span> <span class="na">value=</span><span class="s">&quot;Chromosome&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;src.data.dir&quot;</span> <span class="na">location=</span><span class="s">&quot;/DATA/*.gff3&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/source&gt;</span>
</pre></div>
</div>
<p>Here are the descriptions of the properties available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="18%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">property</th>
<th class="head">example</th>
<th class="head">definition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>gff3.seqClsName</td>
<td>Chromosome</td>
<td>the ids in the first column represent Chromosome objects, e.g. MAL1</td>
</tr>
<tr class="row-odd"><td>gff3.taxonId</td>
<td>36329</td>
<td>taxon id of malaria</td>
</tr>
<tr class="row-even"><td>gff3.dataSourceName</td>
<td>PlasmoDB</td>
<td>the data source for features and their identifiers, this is used for the DataSet (evidence) and synonyms.</td>
</tr>
<tr class="row-odd"><td>gff3.seqDataSourceName</td>
<td>PlasmoDB</td>
<td>the source of the seqids (chromosomes) is sometimes different to the features described</td>
</tr>
<tr class="row-even"><td>gff3.dataSetTitle</td>
<td>PlasmoDB P. falciparum genome</td>
<td>a DataSet object is created as evidence for the features, it is linked to a  DataSource (PlasmoDB)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="writing-a-custom-gff-parser">
<h4>Writing a custom GFF parser<a class="headerlink" href="#writing-a-custom-gff-parser" title="Permalink to this headline">¶</a></h4>
<p>You can extend the generic parser by writing your own Java code to process the GFF3 data.</p>
</div>
</div>
<div class="section" id="make-source-script">
<h3>Make Source script<a class="headerlink" href="#make-source-script" title="Permalink to this headline">¶</a></h3>
<p>Create your custom source by running the create source script:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>./bio/scripts/make_source mouse-cdna gff
created /home/USER_NAME/git/bio/sources/mouse-cdna directory <span class="k">for </span>mouse-cdna
</pre></div>
</div>
<p>The script has created a new source for you in the <cite>bio/sources</cite> directory.</p>
</div>
<div class="section" id="java-code">
<h3>Java code<a class="headerlink" href="#java-code" title="Permalink to this headline">¶</a></h3>
<p>The Java file you now want to edit is here: <cite>bio/sources/SOURCE_NAME/main/src/org/intermine/bio/dataconversion</cite></p>
<p>The <cite>process()</cite> method is called for every line of GFF3 file(s) being read.  Features and their locations are already created but not stored so you can make changes here.  Attributes are from the last column of the file are available in a map with the attribute name as the key.   For example:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Item</span> <span class="n">feature</span> <span class="o">=</span> <span class="n">getFeature</span><span class="o">();</span>
<span class="n">String</span> <span class="n">symbol</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getAttributes</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;symbol&quot;</span><span class="o">);</span>
<span class="n">feature</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&quot;symbol&quot;</span><span class="o">,</span> <span class="n">symbol</span><span class="o">);</span>
</pre></div>
</div>
<p>Any new Items created can be stored by calling addItem().  For example:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">String</span> <span class="n">geneIdentifier</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getAttributes</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;gene&quot;</span><span class="o">);</span>
<span class="n">gene</span> <span class="o">=</span> <span class="n">createItem</span><span class="o">(</span><span class="s">&quot;Gene&quot;</span><span class="o">);</span>
<span class="n">gene</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&quot;primaryIdentifier&quot;</span><span class="o">,</span> <span class="n">geneIdentifier</span><span class="o">);</span>
<span class="n">addItem</span><span class="o">(</span><span class="n">gene</span><span class="o">);</span>
</pre></div>
</div>
<p>You should make sure that new Items you create are unique, i.e. by storing in a map by some identifier.</p>
<p>It may be helpful to look at current GFF3 parsers:</p>
<ol class="arabic simple">
<li><cite>LongOligoGFF3RecordHandler.java</cite></li>
<li><cite>MirandaGFF3RecordHandler.java</cite></li>
<li><cite>RedFlyGFF3RecordHandler.java</cite></li>
<li><cite>FlyRegGFF3RecordHandler.java</cite></li>
<li><cite>DrosDelGFF3RecordHandler.java</cite></li>
</ol>
<p>See <a class="reference internal" href="../../../get-started/tutorial/index.html"><em>Tutorial</em></a> for more information on how to run a GFF source.</p>
<span class="target" id="index-0"></span></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="identifiers/index.html" title="Identifier Data Sources"
             >next</a> |</li>
        <li class="right" >
          <a href="fasta.html" title="FASTA"
             >previous</a> |</li>
        <li><a href="../../../index.html">InterMine  documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Database</a> &raquo;</li>
          <li><a href="../index.html" >Data Sources</a> &raquo;</li>
          <li><a href="index.html" >Data Source Library</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
                &copy; Copyright 2012, University of Cambridge.
            Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>